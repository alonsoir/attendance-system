setup:
  addons:
    - plan: heroku-postgresql:hobby-dev
    - plan: heroku-redis:hobby-dev

build:
  docker:
    web: Dockerfile
    worker: Dockerfile

release:
  command:
    - alembic upgrade head
  image: web

run:
  web: uvicorn backend.main:app --host 0.0.0.0 --port $PORT
  worker: celery -A backend.worker worker --loglevel=info